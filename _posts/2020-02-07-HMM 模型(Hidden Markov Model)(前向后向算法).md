## HMM æ¨¡å‹(Hidden Markov Model)(å‰å‘åå‘ç®—æ³•)

HMMçš„é—®é¢˜ä¸€æ˜¯:å·²çŸ¥HMMæ¨¡å‹çš„å‚æ•°$\lambda = (A, B, \Pi)$ã€‚å…¶ä¸­ğ´æ˜¯éšè—çŠ¶æ€è½¬ç§»æ¦‚ç‡çš„çŸ©é˜µï¼Œğµæ˜¯è§‚æµ‹çŠ¶æ€ç”Ÿæˆæ¦‚ç‡çš„çŸ©é˜µï¼Œ $\Pi$æ˜¯éšè—çŠ¶æ€çš„åˆå§‹æ¦‚ç‡åˆ†å¸ƒã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿå·²ç»å¾—åˆ°äº†è§‚æµ‹åºåˆ—$O =\{o_1,o_2,...o_T\}$ã€‚ç°åœ¨æˆ‘ä»¬è¦æ±‚è§‚æµ‹åºåˆ—ğ‘‚åœ¨æ¨¡å‹Î»ä¸‹å‡ºç°çš„æ¡ä»¶æ¦‚ç‡ğ‘ƒ(ğ‘‚|ğœ†)ã€‚

### æš´åŠ›æ±‚è§£

æ ¹æ®HMMçš„ç¬¬äºŒä¸ªå‡è®¾ï¼Œæˆ‘ä»¬çŸ¥é“è§‚æµ‹åºåˆ—è‚¯å®šæ˜¯ä¸$I$ç›¸å…³çš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŸå§‹å…¬å¼$ğ‘ƒ(ğ‘‚|ğœ†)$ä¸­åŠ å…¥å˜é‡$I$,æ ¹æ®è”åˆæ¦‚ç‡å…¬å¼
$$
P(O|\lambda) = \sum\limits_{I}P(O,I|\lambda)  =\sum\limits_{I}P(O,I|\lambda) = \sum\limits_{I}P(I|\lambda)P(O|I, \lambda)
$$
å…¶ä¸­
$$
P(I|\lambda) = p(i_T|i_{T-1},i_{T-2},...i_1|\lambda)*p(i_{T-1},i_{T-2},...i_1|\lambda)
$$
æ ¹æ®HMMçš„ç¬¬ä¸€ä¸ªå‡è®¾å…¶ä¸­$p(i_T|i_{T-1},i_{T-2},...i_1|\lambda) = p(i_T|i_{t-1})$ ï¼Œå› æ­¤
$$
P(I|\lambda) = \pi_{i_1} a_{i_1i_2} a_{i_2i_3}... a_{i_{T-1}\;\;i_T}
$$
åŒç†,ä½¿ç”¨HMMçš„ç¬¬äºŒä¸ªå‡è®¾å¯å¾—ï¼š
$$
P(O|I, \lambda) = b_{i_1}(o_1)b_{i_2}(o_2)...b_{i_T}(o_T)
$$
å› æ­¤ï¼š
$$
P(O|\lambda) = \sum\limits_{i_1,i_2,...i_T}\pi_{i_1}b_{i_1}(o_1)a_{i_1i_2}b_{i_2}(o_2)...a_{i_{T-1}\;\;i_T}b_{i_T}(o_T)
$$
è§‚å¯Ÿåˆ°æˆ‘ä»¬åºåˆ—çš„é•¿åº¦ä¸ºTï¼Œæ¯ä¸ªæ—¶é—´ç‚¹å–å€¼çš„å¯èƒ½æ€§ä¸ºNï¼Œå› æ­¤ç›´æ¥ç©·ä¸¾çš„è¯æ—¶é—´å¤æ‚åº¦ä¸º$O(N^T)$ã€‚

### å‰å‘ç®—æ³•

å‰å‘ç®—æ³•æœ¬è´¨ä¸Šå±äºåŠ¨æ€è§„åˆ’çš„ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦é€šè¿‡æ‰¾åˆ°å±€éƒ¨çŠ¶æ€é€’æ¨çš„å…¬å¼ï¼Œè¿™æ ·ä¸€æ­¥æ­¥çš„ä»å­é—®é¢˜çš„æœ€ä¼˜è§£æ‹“å±•åˆ°æ•´ä¸ªé—®é¢˜çš„æœ€ä¼˜è§£ã€‚

åœ¨å‰å‘ç®—æ³•ä¸­ï¼Œé€šè¿‡å®šä¹‰"å‰å‘æ¦‚ç‡â€œæ¥å®šä¹‰åŠ¨æ€è§„åˆ’çš„è¿™ä¸ªå±€éƒ¨è½¬æ”¹ã€‚ä»€ä¹ˆæ˜¯å‰å‘æ¦‚ç‡å‘¢ï¼Œå…¶å®å®šä¹‰å¾ˆç®€å•ï¼šå®šä¹‰æ—¶åˆ»tæ—¶åˆ»çš„éšè—çŠ¶æ€ä¸º$q_c$,è§‚æµ‹çŠ¶æ€çš„åºåˆ—ä¸º$o_1,o_2,...o_t$ çš„æ¦‚ç‡ä¸ºå‰å‘æ¦‚ç‡ï¼Œè®°ä¸ºï¼š
$$
\alpha_t(c) = P(o_1,o_2,...o_t, i_t =q_c | \lambda)
$$
æ—¢ç„¶æ˜¯åŠ¨æ€è§„åˆ’ï¼Œæˆ‘ä»¬å°±è¦é€’æ¨äº†ï¼Œç°åœ¨æˆ‘ä»¬å‡è®¾æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†åœ¨æ—¶åˆ»ğ‘¡tæ—¶å„ä¸ªéšè—çŠ¶æ€çš„å‰å‘æ¦‚ç‡ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦é€’æ¨å‡ºæ—¶åˆ»t+1æ—¶å„ä¸ªéšè—çŠ¶æ€çš„å‰å‘æ¦‚ç‡ã€‚å…¶ä¸­ï¼š
$$
a_{t+1}(d) = P(o_1,o_2,...o_t,o_{t+1}, i_{t+1}=q_d | \lambda)
$$
ç°åœ¨å¼€å§‹æ‰¾$a_{t+1}$å’Œ $a_t$çš„å…³ç³»ã€‚
$$
\begin{align} a_{t+1}(d)&= \sum\limits_{c=1}^N P(o_1,o_2,...o_t,o_{t+1}, i_t =q_c,i_{t+1}=q_d | \lambda) \\
& = \sum\limits_{c=1}^N P(o_{t+1}|o_1,o_2,...o_t, i_t =q_c,i_{t+1}=q_d )P(o_1,o_2,...o_t,, i_t =q_c,i_{t+1}=q_d | \lambda) \end{align}
$$
æ ¹æ®HMMçš„å‡è®¾ï¼š
$$
P(o_{t+1}|o_1,o_2,...o_t, i_t =q_c,i_{t+1}=q_d ) = b_d(o_{t+1})
$$

$$
\begin{align}
P(o_1,o_2,...o_t,, i_t =q_c,i_{t+1}=q_d | \lambda)  
= P(i_{t+1}=q_d|o_1,o_2,...o_t,i_t =q_c | \lambda) * a_{t+1}(d) = a_{cd} a_{t+1}(d)
\end{align}
$$

å› æ­¤$a_{t+1}$ å’Œ $a_t$ çš„é€’æ¨å…³ç³»å¯ä»¥è¡¨ç¤ºä¸ºï¼š
$$
\alpha_{t+1}(d) = \Big[\sum\limits_{c=1}^N\alpha_t(c)a_{cd}\Big]b_d(o_{t+1})
$$
æˆ‘ä»¬çš„åŠ¨æ€è§„åˆ’ä»æ—¶åˆ»1å¼€å§‹ï¼Œåˆ°æ—¶åˆ»ğ‘‡ç»“æŸï¼Œç”±äº$a_T(i)$è¡¨ç¤ºåœ¨æ—¶åˆ»ğ‘‡Tè§‚æµ‹åºåˆ—ä¸º$o_1,o_2,...o_T$ï¼Œå¹¶ä¸”æ—¶åˆ»ğ‘‡Téšè—çŠ¶æ€$q_i$çš„æ¦‚ç‡ï¼Œæˆ‘ä»¬åªè¦å°†æ‰€æœ‰éšè—çŠ¶æ€å¯¹åº”çš„æ¦‚ç‡ç›¸åŠ ï¼Œå³$\sum\limits_{i=1}^N\alpha_T(i)$å°±å¾—åˆ°äº†åœ¨æ—¶åˆ»ğ‘‡Tè§‚æµ‹åºåˆ—ä¸º$o_1,o_2,...o_T$çš„æ¦‚ç‡ã€‚

### åå‘ç®—æ³•

åå‘ç®—æ³•å’Œå‰å‘ç®—æ³•éå¸¸ç±»ä¼¼ï¼Œéƒ½æ˜¯ç”¨çš„åŠ¨æ€è§„åˆ’ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯é€‰æ‹©çš„å±€éƒ¨çŠ¶æ€ä¸åŒï¼Œåå‘ç®—æ³•ç”¨çš„æ˜¯â€œåå‘æ¦‚ç‡â€ï¼Œå®šä¹‰æ—¶åˆ»tæ—¶éšè—çŠ¶æ€ä¸º$ q_c $, ä»æ—¶åˆ»t+1åˆ°æœ€åæ—¶åˆ»ğ‘‡çš„è§‚æµ‹çŠ¶æ€çš„åºåˆ—ä¸º$o_{t+1},o_{t+2},...o_T$çš„æ¦‚ç‡ä¸ºåå‘æ¦‚ç‡ã€‚è®°ä¸ºï¼š
$$
\beta_t(c) = P(o_{t+1},o_{t+2},...o_T| i_t =q_c , \lambda)
$$
åå‘æ¦‚ç‡çš„åŠ¨æ€è§„åˆ’é€’æ¨å…¬å¼å’Œå‰å‘æ¦‚ç‡æ˜¯ç›¸åçš„ã€‚ç°åœ¨æˆ‘ä»¬å‡è®¾æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†åœ¨æ—¶åˆ»t+1æ—¶å„ä¸ªéšè—çŠ¶æ€çš„åå‘æ¦‚ç‡$\beta_{t+1}(j)$
$$
\beta_{t+1}(d) = P(o_{t+2},o_{t+3},...o_T| i_{t+1} =q_d , \lambda)
$$
ç°åœ¨å¼€å§‹æ‰¾$\beta_t$ å’Œ$\beta_{t+1}$ çš„å…³ç³»:
$$
\begin{align}
\beta_t(c) &= \sum_{d=1}^NP(o_{t+1},o_{t+2},...o_T,i_{t+1}=q_d| i_t =q_c,\lambda)\\
&=\sum_{d=1}^NP(o_{t+1},o_{t+2},...o_T| i_{t+1}=q_d,i_t =q_c,\lambda)P(i_{t+1}=q_d|i_t =q_c,\lambda) \\
&=\sum_{d=1}^NP(o_{t+1},o_{t+2},...o_T| i_{t+1}=q_d,\lambda)P(i_{t+1}=q_d|i_t =q_c,\lambda)) \\
&=\sum_{d=1}^NP(o_{t+1}|o_{t+2},...o_T|i_{t+1}=q_d,\lambda)P(o_{t+2},o_{t+3},...o_T| i_{t+1} =q_d , \lambda)a_{cd} \\
& =\sum_{d=1}^N b_j(O_{t+1})a_{ij}\beta_{t+1}(j)

\end{align}
$$
æ‰¾åˆ°é€’æ¨å…³ç³»å¼åï¼Œæˆ‘ä»¬çœ‹$P(O|\lambda)$ ä¸ $\beta$ çš„å…³ç³»
$$
\begin{align}
P(O|\lambda) &= P(o_1,...,o_T|\lambda) \\
& =\sum_{i=1}^N P(o_1,...,o_T,i_1 = q_c|\lambda)\\
& = \sum_{i=1}^N P(o_1,...,o_T|i_1 = q_c,\lambda)P(i_1=q_c|\lambda) \\
& = \sum_{i=1}^NP(O_1|O_2,...O_T|i_1 = q_c,\lambda)P(O_2,...O_T|i_1 = q_c,\lambda)P(i_1=q_c|\lambda) \\
& =  \sum_{i=1}^N b_c(O_1) \beta_1(c)\pi_c
\end{align}
$$

